<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>경사 계산기</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      max-width: 600px;
      margin: 30px auto;
      padding: 20px;
    }
    h1 {
      font-size: 24px;
      font-weight: bold;
    }
    label {
      font-weight: bold;
      display: block;
      margin-top: 15px;
    }
    input, select {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      box-sizing: border-box;
      font-size: 16px;
    }
    button {
      margin-top: 20px;
      background-color: #4CAF50;
      color: white;
      border: none;
      padding: 12px 20px;
      cursor: pointer;
      font-size: 16px;
      width: 100%;
    }
    .result {
      margin-top: 25px;
      font-size: 16px;
      line-height: 1.6;
    }
    canvas {
      margin-top: 20px;
      border: 1px solid #ccc;
    }
  </style>
</head>
<body>
  <h1>경사 계산기</h1>
  <label for="height">높이 (mm):</label>
  <input type="number" id="height" placeholder="예: 3000" />

  <label for="length">거리 (mm):</label>
  <input type="number" id="length" placeholder="예: 2000" />

  <label for="diameter">외경 (mm):</label>
  <input type="number" id="diameter" placeholder="예: 50" />

  <label for="elbowType">엘보 방향:</label>
  <select id="elbowType">
    <option value="left">좌측</option>
    <option value="right">우측</option>
  </select>

  <button onclick="calculate()">계산하기</button>

  <div class="result" id="result"></div>
  <canvas id="canvas" width="400" height="400"></canvas>

  <script>
    function calculate() {
      const height = parseFloat(document.getElementById('height').value);
      const length = parseFloat(document.getElementById('length').value);
      const diameter = parseFloat(document.getElementById('diameter').value);
      const elbowType = document.getElementById('elbowType').value;

      if (isNaN(height) || isNaN(length) || isNaN(diameter)) {
        alert('모든 값을 입력해주세요.');
        return;
      }

      const diagonal = Math.sqrt(height ** 2 + length ** 2);
      const slopePercent = (height / length) * 100;
      const angleDeg = Math.atan(height / length) * (180 / Math.PI);

      // 엘보 치수 계산
      const leftBend = length - diameter * 0.75;
      const rightBend = height - diameter * 0.75;

      let resultText = `
        <b>높이:</b> ${height.toFixed(2)}mm<br/>
        <b>거리:</b> ${length.toFixed(2)}mm<br/>
        <b>외경:</b> ${diameter.toFixed(2)}mm<br/>
        <b>경사율:</b> ${slopePercent.toFixed(2)}%<br/>
        <b>경사각도:</b> ${angleDeg.toFixed(2)}°<br/>
        <b>대각선 거리:</b> ${diagonal.toFixed(2)}mm<br/><br/>
        <b>엘보 기준 벤딩 치수</b><br/>
      `;

      if (elbowType === "left") {
        resultText += `좌측 치수: ${leftBend.toFixed(2)}mm`;
      } else {
        resultText += `우측 치수: ${rightBend.toFixed(2)}mm`;
      }

      document.getElementById('result').innerHTML = resultText;

      drawTriangle(length, height, elbowType, diameter);
    }

    function drawTriangle(base, height, type, diameter) {
      const canvas = document.getElementById('canvas');
      const ctx = canvas.getContext('2d');
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      const scale = Math.min(300 / base, 300 / height);
      const x0 = 50;
      const y0 = 350;
      const x1 = x0 + base * scale;
      const y1 = y0;
      const x2 = (type === "right") ? x1 : x0;
      const y2 = y0 - height * scale;

      // 밑변
      ctx.strokeStyle = '#999';
      ctx.beginPath();
      ctx.moveTo(x0, y0);
      ctx.lineTo(x1, y1);
      ctx.stroke();

      // 높이
      ctx.strokeStyle = '#999';
      ctx.beginPath();
      ctx.moveTo(x2, y1);
      ctx.lineTo(x2, y2);
      ctx.stroke();

      // 대각선
      ctx.strokeStyle = '#f00';
      ctx.beginPath();
      ctx.moveTo(x0, y0);
      ctx.lineTo(x2, y2);
      ctx.stroke();

      // 라벨
      ctx.fillStyle = '#000';
      ctx.font = '14px Arial';
      ctx.fillText(`거리: ${base.toFixed(0)}mm`, (x0 + x1) / 2 - 30, y0 + 15);
      ctx.fillText(`높이: ${height.toFixed(0)}mm`, x2 + 5, (y1 + y2) / 2);
      ctx.fillText(`대각선`, (x0 + x2) / 2 - 20, (y0 + y2) / 2 - 10);
    }
  </script>
</body>
</html>
